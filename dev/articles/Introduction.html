<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction â€¢ openxlsx</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openxlsx</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">4.2.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Formatting.html">Formating with xlsx</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ycphs/openxlsx/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
                        <h4 data-toc-skip class="author">Alexander
Walker, Philipp Schauberger</h4>
            
            <h4 data-toc-skip class="date">2024-09-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ycphs/openxlsx/blob/master/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="basic-examples">Basic Examples<a class="anchor" aria-label="anchor" href="#basic-examples"></a>
</h2>
<div class="section level3">
<h3 id="write-xlsx">write.xlsx<a class="anchor" aria-label="anchor" href="#write-xlsx"></a>
</h3>
<p>The simplest way to write to a workbook is write.xlsx(). By default,
write.xlsx calls writeData. If asTable is TRUE write.xlsx will write x
as an Excel table.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## write to working directory</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html" class="external-link">openxlsx</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"writeXLSX1.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"writeXLSXTable1.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="write-list-of-data-frames-to-xlsx-file">write list of data.frames to xlsx-file<a class="anchor" aria-label="anchor" href="#write-list-of-data-frames-to-xlsx-file"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## write a list of data.frames to individual worksheets using list names as worksheet names</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"IRIS"</span> <span class="op">=</span> <span class="va">iris</span>, <span class="st">"MTCARS"</span> <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">l</span>, file <span class="op">=</span> <span class="st">"writeXLSX2.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">l</span>, file <span class="op">=</span> <span class="st">"writeXLSXTable2.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="write-xlsx-also-accepts-styling-parameters">write.xlsx also accepts styling parameters<a class="anchor" aria-label="anchor" href="#write-xlsx-also-accepts-styling-parameters"></a>
</h3>
<div class="section level4">
<h4 id="the-simplest-way-is-to-set-default-options-and-set-column-class">The simplest way is to set default options and set column class<a class="anchor" aria-label="anchor" href="#the-simplest-way-is-to-set-default-options-and-set-column-class"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx.borderColour"</span> <span class="op">=</span> <span class="st">"#4F80BD"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx.borderStyle"</span> <span class="op">=</span> <span class="st">"thin"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx.dateFormat"</span> <span class="op">=</span> <span class="st">"mm/dd/yyyy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx.datetimeFormat"</span> <span class="op">=</span> <span class="st">"yyyy-mm-dd hh:mm:ss"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx.numFmt"</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co">## For default style rounding of numeric columns</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Date"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">0</span><span class="op">:</span><span class="fl">19</span>, <span class="st">"LogicalT"</span> <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 <span class="st">"Time"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">0</span><span class="op">:</span><span class="fl">19</span><span class="op">*</span><span class="fl">60</span><span class="op">*</span><span class="fl">60</span>,</span>
<span>                 <span class="st">"Cash"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"$"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="st">"Cash2"</span> <span class="op">=</span> <span class="fl">31</span><span class="op">:</span><span class="fl">50</span>,</span>
<span>                 <span class="st">"hLink"</span> <span class="op">=</span> <span class="st">"https://CRAN.R-project.org/"</span>,</span>
<span>                 <span class="st">"Percentage"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out<span class="op">=</span><span class="fl">20</span><span class="op">)</span>,</span>
<span>                 <span class="st">"TinyNumbers"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1E9</span>,  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"currency"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"accounting"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">hLink</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"hyperlink"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Percentage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"percentage"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">TinyNumbers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"scientific"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"writeXLSX3.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">df</span>, file <span class="op">=</span> <span class="st">"writeXLSXTable3.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="workbook-styles">Workbook styles<a class="anchor" aria-label="anchor" href="#workbook-styles"></a>
</h2>
<div class="section level3">
<h3 id="define-a-style-for-column-headers">define a style for column headers<a class="anchor" aria-label="anchor" href="#define-a-style-for-column-headers"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>fontColour <span class="op">=</span> <span class="st">"#ffffff"</span>, fgFill <span class="op">=</span> <span class="st">"#4F80BD"</span>,</span>
<span>                  halign <span class="op">=</span> <span class="st">"center"</span>, valign <span class="op">=</span> <span class="st">"center"</span>, textDecoration <span class="op">=</span> <span class="st">"Bold"</span>,</span>
<span>                  border <span class="op">=</span> <span class="st">"TopBottomLeftRight"</span>, textRotation <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"writeXLSX4.xlsx"</span>, borders <span class="op">=</span> <span class="st">"rows"</span>, headerStyle <span class="op">=</span> <span class="va">hs</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="st">"writeXLSX5.xlsx"</span>, borders <span class="op">=</span> <span class="st">"columns"</span>, headerStyle <span class="op">=</span> <span class="va">hs</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, <span class="st">"writeXLSXTable4.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>headerStyle <span class="op">=</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>textRotation <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="when-writing-a-list-the-stylings-will-apply-to-all-list-elements">When writing a list, the stylings will apply to all list
elements<a class="anchor" aria-label="anchor" href="#when-writing-a-list-the-stylings-will-apply-to-all-list-elements"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"IRIS"</span> <span class="op">=</span> <span class="va">iris</span>, <span class="st">"colClasses"</span> <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">l</span>, file <span class="op">=</span> <span class="st">"writeXLSX6.xlsx"</span>, borders <span class="op">=</span> <span class="st">"columns"</span>, headerStyle <span class="op">=</span> <span class="va">hs</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">l</span>, file <span class="op">=</span> <span class="st">"writeXLSXTable5.xlsx"</span>, asTable <span class="op">=</span> <span class="cn">TRUE</span>, tableStyle <span class="op">=</span> <span class="st">"TableStyleLight2"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/openXL.html">openXL</a></span><span class="op">(</span><span class="st">"writeXLSX6.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/openXL.html">openXL</a></span><span class="op">(</span><span class="st">"writeXLSXTable5.xlsx"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="write-xlsx-returns-the-workbook-object-for-further-editing">write.xlsx returns the workbook object for further editing<a class="anchor" aria-label="anchor" href="#write-xlsx-returns-the-workbook-object-for-further-editing"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">iris</span>, <span class="st">"writeXLSX6.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, widths <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/saveWorkbook.html">saveWorkbook</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"writeXLSX6.xlsx"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="workbook-creation-walk-through">Workbook creation walk-through<a class="anchor" aria-label="anchor" href="#workbook-creation-walk-through"></a>
</h2>
<div class="section level3">
<h3 id="create-workbook-and-set-default-border-colour-and-style">create workbook and set default border Colour and style<a class="anchor" aria-label="anchor" href="#create-workbook-and-set-default-border-colour-and-style"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWorkbook.html">createWorkbook</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx.borderColour"</span> <span class="op">=</span> <span class="st">"#4F80BD"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx.borderStyle"</span> <span class="op">=</span> <span class="st">"thin"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/modifyBaseFont.html">modifyBaseFont</a></span><span class="op">(</span><span class="va">wb</span>, fontSize <span class="op">=</span> <span class="fl">10</span>, fontName <span class="op">=</span> <span class="st">"Arial Narrow"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-sheets">Add Sheets<a class="anchor" aria-label="anchor" href="#add-sheets"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, sheetName <span class="op">=</span> <span class="st">"Motor Trend Car Road Tests"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, sheetName <span class="op">=</span> <span class="st">"Iris"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="write-data-to-sheet-1">write data to sheet 1<a class="anchor" aria-label="anchor" href="#write-data-to-sheet-1"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/freezePane.html">freezePane</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, firstRow <span class="op">=</span> <span class="cn">TRUE</span>, firstCol <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">## freeze first row and column</span></span>
<span><span class="fu"><a href="../reference/writeDataTable.html">writeDataTable</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, x <span class="op">=</span> <span class="va">mtcars</span>,</span>
<span>colNames <span class="op">=</span> <span class="cn">TRUE</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>tableStyle <span class="op">=</span> <span class="st">"TableStyleLight9"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="st">"A"</span>, widths <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="write-data-to-sheet-2">write data to sheet 2<a class="anchor" aria-label="anchor" href="#write-data-to-sheet-2"></a>
</h3>
<p>iris data.frame is added as excel table on sheet 2.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/writeDataTable.html">writeDataTable</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">2</span>, <span class="va">iris</span>, startCol <span class="op">=</span> <span class="st">"K"</span>, startRow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">qplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">iris</span>, x <span class="op">=</span> <span class="va">Sepal.Length</span>, y<span class="op">=</span> <span class="va">Sepal.Width</span>, colour <span class="op">=</span> <span class="va">Species</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, xy<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span> <span class="co">## insert plot at cell B16</span></span>
<span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">var</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-write-group-means">add write group means<a class="anchor" aria-label="anchor" href="#add-write-group-means"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">headSty</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>fgFill<span class="op">=</span><span class="st">"#DCE6F1"</span>, halign<span class="op">=</span><span class="st">"center"</span>, border <span class="op">=</span> <span class="st">"TopBottomLeftRight"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x <span class="op">=</span> <span class="st">"Iris dataset group means"</span>, startCol <span class="op">=</span> <span class="fl">2</span>, startRow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x <span class="op">=</span> <span class="va">means</span>, startCol <span class="op">=</span> <span class="st">"B"</span>, startRow<span class="op">=</span><span class="fl">3</span>, borders<span class="op">=</span><span class="st">"rows"</span>, headerStyle <span class="op">=</span> <span class="va">headSty</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-write-group-variances">add write group variances<a class="anchor" aria-label="anchor" href="#add-write-group-variances"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x <span class="op">=</span> <span class="st">"Iris dataset group variances"</span>, startCol <span class="op">=</span> <span class="fl">2</span>, startRow <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x<span class="op">=</span> <span class="va">vars</span>, startCol <span class="op">=</span> <span class="st">"B"</span>, startRow<span class="op">=</span><span class="fl">10</span>, borders<span class="op">=</span><span class="st">"columns"</span>,</span>
<span>headerStyle <span class="op">=</span> <span class="va">headSty</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span>, widths <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="co">## width is recycled for each col</span></span>
<span><span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, cols<span class="op">=</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, widths <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-style-mean-variance-table-headers">add style mean &amp; variance table headers<a class="anchor" aria-label="anchor" href="#add-style-mean-variance-table-headers"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>fontSize<span class="op">=</span><span class="fl">14</span>, textDecoration<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bold"</span>, <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addStyle.html">addStyle</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, style <span class="op">=</span> <span class="va">s1</span>, rows<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">9</span><span class="op">)</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="save-workbook">save workbook<a class="anchor" aria-label="anchor" href="#save-workbook"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/saveWorkbook.html">saveWorkbook</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"basics.xlsx"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">## save to working directory</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="gallery">Gallery<a class="anchor" aria-label="anchor" href="#gallery"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## inspired by xtable gallery</span></span>
<span><span class="co">#https://CRAN.R-project.org/package=xtable/vignettes/xtableGallery.pdf</span></span>
<span></span>
<span><span class="co">## Create a new workbook</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWorkbook.html">createWorkbook</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tli</span>, package <span class="op">=</span> <span class="st">"xtable"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## data.frame</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"data.frame"</span></span>
<span><span class="va">my.df</span> <span class="op">&lt;-</span> <span class="va">tli</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">my.df</span>, borders <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## matrix</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"matrix"</span></span>
<span><span class="va">design.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">sex</span> <span class="op">*</span> <span class="va">grade</span>, data <span class="op">=</span> <span class="va">my.df</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">design.matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## aov</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"aov"</span></span>
<span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">tlimth</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">ethnicty</span> <span class="op">+</span> <span class="va">grade</span> <span class="op">+</span> <span class="va">disadvg</span>, data <span class="op">=</span> <span class="va">tli</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">fm1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## lm</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"lm"</span></span>
<span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">tlimth</span> <span class="op">~</span> <span class="va">sex</span><span class="op">*</span><span class="va">ethnicty</span>, data <span class="op">=</span> <span class="va">tli</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">fm2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## anova 1 </span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"anova"</span></span>
<span><span class="va">my.anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">my.anova</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## anova 2</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"anova2"</span></span>
<span><span class="va">fm2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">tlimth</span> <span class="op">~</span> <span class="va">ethnicty</span>, data <span class="op">=</span> <span class="va">tli</span><span class="op">)</span></span>
<span><span class="va">my.anova2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fm2b</span>, <span class="va">fm2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">my.anova2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## glm</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"glm"</span></span>
<span><span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">disadvg</span> <span class="op">~</span> <span class="va">ethnicty</span><span class="op">*</span><span class="va">grade</span>, data <span class="op">=</span> <span class="va">tli</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">fm3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## prcomp</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"prcomp"</span></span>
<span><span class="va">pr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">pr1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## summary.prcomp</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"summary.prcomp"</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pr1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## simple table</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"table"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span>
<span><span class="va">airquality</span><span class="op">$</span><span class="va">OzoneG80</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Ozone</span> <span class="op">&gt;</span> <span class="fl">80</span>,</span>
<span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Oz &lt;= 80"</span>, <span class="st">"Oz &gt; 80"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">airquality</span><span class="op">$</span><span class="va">Month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Month</span>,</span>
<span>levels <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">9</span>,</span>
<span>labels <span class="op">=</span> <span class="va">month.abb</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">my.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">airquality</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">OzoneG80</span>,<span class="va">Month</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">my.table</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## survdiff 1</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"survdiff1"</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span>, data <span class="op">=</span> <span class="va">ovarian</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## survdiff 2</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"survdiff2"</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="va">expect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survexp.html" class="external-link">survexp</a></span><span class="op">(</span><span class="va">futime</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/ratetable.html" class="external-link">ratetable</a></span><span class="op">(</span>age<span class="op">=</span><span class="op">(</span><span class="va">accept.dt</span> <span class="op">-</span> <span class="va">birth.dt</span><span class="op">)</span>,</span>
<span>      sex<span class="op">=</span><span class="fl">1</span>,year<span class="op">=</span><span class="va">accept.dt</span>,race<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>, <span class="va">jasa</span>, cohort<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>      ratetable<span class="op">=</span><span class="va">survexp.usr</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">jasa</span><span class="op">$</span><span class="va">futime</span>, <span class="va">jasa</span><span class="op">$</span><span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="va">expect</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## coxph 1</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"coxph1"</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="va">bladder</span><span class="op">$</span><span class="va">rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">bladder</span><span class="op">$</span><span class="va">rx</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pla"</span>,<span class="st">"Thi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">stop</span>,<span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span>, data <span class="op">=</span> <span class="va">bladder</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## coxph 2</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"coxph2"</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">stop</span>,<span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">bladder</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## cox.zph</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"cox.zph"</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/cox.zph.html" class="external-link">cox.zph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">futime</span>, <span class="va">fustat</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ecog.ps</span>,  data<span class="op">=</span><span class="va">ovarian</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## summary.coxph 1</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"summary.coxph1"</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">stop</span>,<span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span>, data <span class="op">=</span> <span class="va">bladder</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## summary.coxph 2</span></span>
<span><span class="va">test.n</span> <span class="op">&lt;-</span> <span class="st">"summary.coxph2"</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheetName <span class="op">=</span> <span class="va">test.n</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">stop</span>,<span class="va">event</span><span class="op">)</span> <span class="op">~</span> <span class="va">rx</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">bladder</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span>wb <span class="op">=</span> <span class="va">wb</span>, sheet <span class="op">=</span> <span class="va">test.n</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## view without saving</span></span>
<span><span class="fu"><a href="../reference/openXL.html">openXL</a></span><span class="op">(</span><span class="va">wb</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="further-examples">Further Examples<a class="anchor" aria-label="anchor" href="#further-examples"></a>
</h2>
<div class="section level3">
<h3 id="stock-price">Stock Price<a class="anchor" aria-label="anchor" href="#stock-price"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWorkbook.html">createWorkbook</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## read historical prices from yahoo finance</span></span>
<span><span class="va">ticker</span> <span class="op">&lt;-</span> <span class="st">"CBA.AX"</span></span>
<span><span class="va">csv.url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://query1.finance.yahoo.com/v7/finance/download/"</span>,</span>
<span><span class="va">ticker</span>, <span class="st">"?period1=1597597610&amp;period2=1629133610&amp;interval=1d&amp;events=history&amp;includeAdjustedClose= TRue"</span><span class="op">)</span></span>
<span><span class="va">prices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="va">csv.url</span><span class="op">)</span>, as.is <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">prices</span><span class="op">$</span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">prices</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span>
<span><span class="va">close</span> <span class="op">&lt;-</span> <span class="va">prices</span><span class="op">$</span><span class="va">Close</span></span>
<span><span class="va">prices</span><span class="op">$</span><span class="va">logReturns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">close</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">close</span><span class="op">)</span><span class="op">]</span><span class="op">/</span><span class="va">close</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">close</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create plot of price series and add to worksheet</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">prices</span>, <span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">Date</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Close</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_line</span><span class="op">(</span>colour<span class="op">=</span><span class="st">"royalblue2"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Price"</span>, title <span class="op">=</span> <span class="va">ticker</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_area</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"royalblue1"</span>,alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">coord_cartesian</span><span class="op">(</span>ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">prices</span><span class="op">$</span><span class="va">Close</span><span class="op">)</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">prices</span><span class="op">$</span><span class="va">Close</span><span class="op">)</span><span class="op">+</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## Add worksheet and write plot to sheet</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, sheetName <span class="op">=</span> <span class="st">"CBA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"J"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Histogram of log returns</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">prices</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">logReturns</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_histogram</span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">0.0025</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Histogram of log returns"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## currency </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">prices</span><span class="op">$</span><span class="va">Close</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"currency"</span> <span class="co">## styles as currency in workbook</span></span>
<span></span>
<span><span class="co">## write historical data and  histogram of returns</span></span>
<span><span class="fu"><a href="../reference/writeDataTable.html">writeDataTable</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="st">"CBA"</span>, x <span class="op">=</span> <span class="va">prices</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, startRow<span class="op">=</span><span class="fl">25</span>, startCol <span class="op">=</span> <span class="st">"J"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Add conditional formatting to show where logReturn &gt; 0.01 using default style</span></span>
<span><span class="fu"><a href="../reference/conditionalFormat.html">conditionalFormat</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="op">(</span><span class="va">prices</span><span class="op">)</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">prices</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>rule <span class="op">=</span> <span class="st">"$H2 &gt; 0.01"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## style log return col as a percentage  </span></span>
<span><span class="va">logRetStyle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>numFmt <span class="op">=</span> <span class="st">"percentage"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/addStyle.html">addStyle</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, style <span class="op">=</span> <span class="va">logRetStyle</span>, rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">prices</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>cols <span class="op">=</span> <span class="st">"H"</span>, gridExpand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, sheet<span class="op">=</span><span class="fl">1</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"F"</span>, <span class="st">"G"</span>, <span class="st">"H"</span><span class="op">)</span>, widths <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## save workbook to working directory</span></span>
<span><span class="fu"><a href="../reference/saveWorkbook.html">saveWorkbook</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"stockPrice.xlsx"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/openXL.html">openXL</a></span><span class="op">(</span><span class="st">"stockPrice.xlsx"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="image-compression-using-pca">Image Compression using PCA<a class="anchor" aria-label="anchor" href="#image-compression-using-pca"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html" class="external-link">openxlsx</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://www.rforge.net/jpeg/" class="external-link">jpeg</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plotFn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">colvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">grey</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">colmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">colvec</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">colvec</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">colmat</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">colmat</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">colmat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">colmat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> , <span class="op">]</span><span class="op">)</span>,</span>
<span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">colvec</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, asp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    bty <span class="op">=</span><span class="st">"n"</span>, frame.plot<span class="op">=</span><span class="cn">FALSE</span>, ann<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Create workbook and add a worksheet, hide gridlines</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createWorkbook.html">createWorkbook</a></span><span class="op">(</span><span class="st">"Einstein"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Original Image"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu">readJPEG</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/find.package.html" class="external-link">path.package</a></span><span class="op">(</span><span class="st">"openxlsx"</span><span class="op">)</span>, <span class="st">"einstein.jpg"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="va">width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## write "Original Image" to cell B2</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, <span class="st">"Original Image"</span>, xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## write Object size to cell B3</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Image object size: %s bytes"</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">A</span><span class="op">+</span><span class="fl">0</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, big.mark<span class="op">=</span><span class="st">','</span><span class="op">)</span><span class="op">)</span>, </span>
<span>          xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>  <span class="co">## equivalent to startCol = 2, startRow = 3</span></span>
<span></span>
<span><span class="co">## Plot image</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu">plotFn</span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## insert plot currently showing in plot window</span></span>
<span><span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, <span class="va">width</span>, <span class="va">height</span>, units<span class="op">=</span><span class="st">"px"</span>, startRow<span class="op">=</span> <span class="fl">5</span>, startCol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>       </span>
<span></span>
<span><span class="co">## SVD of covariance matrix</span></span>
<span><span class="va">rMeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="va">rowMeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"cbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="va">rMeans</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">A</span> <span class="op">-</span> <span class="va">rowMeans</span></span>
<span><span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># SVD on covariance matrix of A</span></span>
<span><span class="va">pve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Eigenvalues"</span> <span class="op">=</span> <span class="va">E</span><span class="op">$</span><span class="va">d</span>, </span>
<span>                  <span class="st">"PVE"</span> <span class="op">=</span> <span class="va">E</span><span class="op">$</span><span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E</span><span class="op">$</span><span class="va">d</span><span class="op">)</span>,</span>
<span>                  <span class="st">"Cumulative PVE"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">E</span><span class="op">$</span><span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E</span><span class="op">$</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## write eigenvalues to worksheet</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Principal Component Analysis"</span><span class="op">)</span></span>
<span><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>fontColour <span class="op">=</span> <span class="st">"#ffffff"</span>, fgFill <span class="op">=</span> <span class="st">"#4F80BD"</span>,</span>
<span>                  halign <span class="op">=</span> <span class="st">"CENTER"</span>, textDecoration <span class="op">=</span> <span class="st">"Bold"</span>,</span>
<span>                  border <span class="op">=</span> <span class="st">"TopBottomLeftRight"</span>, borderColour <span class="op">=</span> <span class="st">"#4F81BD"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x<span class="op">=</span><span class="st">"Proportions of variance explained by Eigenvector"</span> ,startRow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mergeCells.html">mergeCells</a></span><span class="op">(</span><span class="va">wb</span>, sheet<span class="op">=</span><span class="fl">2</span>, cols<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, rows<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/setColWidths.html">setColWidths</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">12</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, x<span class="op">=</span><span class="va">pve</span>, startRow <span class="op">=</span> <span class="fl">3</span>, startCol <span class="op">=</span> <span class="fl">1</span>, borders<span class="op">=</span><span class="st">"rows"</span>, headerStyle<span class="op">=</span><span class="va">hs</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plots</span></span>
<span><span class="va">pve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pve</span>, <span class="st">"Ind"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pve</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">pve</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Ind</span>, y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">PVE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat<span class="op">=</span><span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Principal Component Index"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Proportion of Variance Explained"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Write plot to worksheet 2</span></span>
<span><span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">4</span>, startCol <span class="op">=</span> <span class="st">"E"</span>, startRow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## Plot of cumulative explained variance</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">pve</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Ind</span>, y <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">Cumulative.PVE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_line</span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"Number of PCs"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Cumulative Proportion of Variance Explained"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, <span class="fl">2</span>, width <span class="op">=</span> <span class="fl">5</span>, height <span class="op">=</span> <span class="fl">4</span>, xy<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co">## Reconstruct image using increasing number of PCs</span></span>
<span><span class="va">nPCs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">12</span>, <span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">startRow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">24</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">startCol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"H"</span>, <span class="st">"N"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## create a worksheet to save reconstructed images to</span></span>
<span><span class="fu"><a href="../reference/addWorksheet.html">addWorksheet</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Reconstructed Images"</span>, zoom <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nPCs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">V</span> <span class="op">&lt;-</span> <span class="va">E</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="va">nPCs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">imgHat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">A</span>  <span class="co">## project img data on to PCs</span></span>
<span>  <span class="va">imgSize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">imgHat</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">rMeans</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">imgHat</span> <span class="op">&lt;-</span> <span class="va">V</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">imgHat</span> <span class="op">+</span> <span class="va">rowMeans</span>  <span class="co">## reconstruct from PCs and add back row means</span></span>
<span>  <span class="va">imgHat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">imgHat</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">imgHat</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">imgHat</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">imgHat</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">255</span><span class="op">)</span> <span class="co"># scale</span></span>
<span>  <span class="fu">plotFn</span><span class="op">(</span><span class="va">imgHat</span><span class="op">/</span><span class="fl">255</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## write strings to worksheet 3</span></span>
<span>  <span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Reconstructed Images"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Number of principal components used:  %s"</span>, </span>
<span>                    <span class="va">nPCs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">startCol</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">startRow</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="../reference/writeData.html">writeData</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Reconstructed Images"</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sum of component object sizes: %s bytes"</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">imgSize</span><span class="op">)</span>, big.mark<span class="op">=</span><span class="st">','</span><span class="op">)</span><span class="op">)</span>, <span class="va">startCol</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">startRow</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## write reconstruced image</span></span>
<span>  <span class="fu"><a href="../reference/insertPlot.html">insertPlot</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Reconstructed Images"</span>, <span class="va">width</span>, <span class="va">height</span>, units<span class="op">=</span><span class="st">"px"</span>,</span>
<span>             xy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">startCol</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">startRow</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># hide grid lines</span></span>
<span><span class="fu"><a href="../reference/showGridLines.html">showGridLines</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">3</span>, showGridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Make text above images BOLD</span></span>
<span><span class="va">boldStyle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createStyle.html">createStyle</a></span><span class="op">(</span>textDecoration<span class="op">=</span><span class="st">"BOLD"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## only want to apply style to specified cells (not all combinations of rows &amp; cols)</span></span>
<span><span class="fu"><a href="../reference/addStyle.html">addStyle</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Reconstructed Images"</span>, style<span class="op">=</span><span class="va">boldStyle</span>, </span>
<span>         rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">startRow</span>, <span class="va">startRow</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">startCol</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>         gridExpand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co">## save workbook to working directory</span></span>
<span><span class="fu"><a href="../reference/saveWorkbook.html">saveWorkbook</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Image dimensionality reduction.xlsx"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">## remove example files for cran test</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"NOT_CRAN"</span>, unset <span class="op">=</span> <span class="st">"true"</span><span class="op">)</span>, <span class="st">"false"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">file_list</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"\\.xlsx"</span>,recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">file_list</span><span class="op">&lt;-</span><span class="va">fl</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"inst/extdata"</span>,<span class="va">file_list</span><span class="op">)</span><span class="op">&amp;</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"man/"</span>,<span class="va">file_list</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">file_list</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">file_list</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Philipp Schauberger, Alexander Walker, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
