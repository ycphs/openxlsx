<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read from an Excel file or Workbook object — read.xlsx • openxlsx</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Read from an Excel file or Workbook object — read.xlsx"><meta property="og:description" content="Read data from an Excel file or Workbook object into a data.frame"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">openxlsx</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">4.2.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Formatting.html">Formating with xlsx</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ycphs/openxlsx/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read from an Excel file or Workbook object</h1>
    <small class="dont-index">Source: <a href="https://github.com/ycphs/openxlsx/blob/master/R/readWorkbook.R" class="external-link"><code>R/readWorkbook.R</code></a></small>
    <div class="hidden name"><code>read.xlsx.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Read data from an Excel file or Workbook object into a data.frame</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read.xlsx</span><span class="op">(</span></span>
<span>  <span class="va">xlsxFile</span>,</span>
<span>  <span class="va">sheet</span>,</span>
<span>  startRow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  colNames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rowNames <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  detectDates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  skipEmptyRows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  skipEmptyCols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sep.names <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  namedRegion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.strings <span class="op">=</span> <span class="st">"NA"</span>,</span>
<span>  fillMergedCells <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-xlsxfile">xlsxFile<a class="anchor" aria-label="anchor" href="#arg-xlsxfile"></a></dt>
<dd><p>An xlsx file, Workbook object or URL to xlsx file.</p></dd>


<dt id="arg-sheet">sheet<a class="anchor" aria-label="anchor" href="#arg-sheet"></a></dt>
<dd><p>The name or index of the sheet to read data from.</p></dd>


<dt id="arg-startrow">startRow<a class="anchor" aria-label="anchor" href="#arg-startrow"></a></dt>
<dd><p>first row to begin looking for data.  Empty rows at the top of a file are always skipped,
regardless of the value of startRow.</p></dd>


<dt id="arg-colnames">colNames<a class="anchor" aria-label="anchor" href="#arg-colnames"></a></dt>
<dd><p>If <code>TRUE</code>, the first row of data will be used as column names.</p></dd>


<dt id="arg-rownames">rowNames<a class="anchor" aria-label="anchor" href="#arg-rownames"></a></dt>
<dd><p>If <code>TRUE</code>, first column of data will be used as row names.</p></dd>


<dt id="arg-detectdates">detectDates<a class="anchor" aria-label="anchor" href="#arg-detectdates"></a></dt>
<dd><p>If <code>TRUE</code>, attempt to recognise dates and perform conversion.</p></dd>


<dt id="arg-skipemptyrows">skipEmptyRows<a class="anchor" aria-label="anchor" href="#arg-skipemptyrows"></a></dt>
<dd><p>If <code>TRUE</code>, empty rows are skipped else empty rows after the first row containing data
will return a row of NAs.</p></dd>


<dt id="arg-skipemptycols">skipEmptyCols<a class="anchor" aria-label="anchor" href="#arg-skipemptycols"></a></dt>
<dd><p>If <code>TRUE</code>, empty columns are skipped.</p></dd>


<dt id="arg-rows">rows<a class="anchor" aria-label="anchor" href="#arg-rows"></a></dt>
<dd><p>A numeric vector specifying which rows in the Excel file to read.
If NULL, all rows are read.</p></dd>


<dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p>A numeric vector specifying which columns in the Excel file to read.
If NULL, all columns are read.</p></dd>


<dt id="arg-check-names">check.names<a class="anchor" aria-label="anchor" href="#arg-check-names"></a></dt>
<dd><p>logical. If TRUE then the names of the variables in the data frame
are checked to ensure that they are syntactically valid variable names</p></dd>


<dt id="arg-sep-names">sep.names<a class="anchor" aria-label="anchor" href="#arg-sep-names"></a></dt>
<dd><p>One character which substitutes blanks in column names. By default, "."</p></dd>


<dt id="arg-namedregion">namedRegion<a class="anchor" aria-label="anchor" href="#arg-namedregion"></a></dt>
<dd><p>A named region in the Workbook. If not NULL startRow, rows and cols parameters are ignored.</p></dd>


<dt id="arg-na-strings">na.strings<a class="anchor" aria-label="anchor" href="#arg-na-strings"></a></dt>
<dd><p>A character vector of strings which are to be interpreted as NA. Blank cells will be returned as NA.</p></dd>


<dt id="arg-fillmergedcells">fillMergedCells<a class="anchor" aria-label="anchor" href="#arg-fillmergedcells"></a></dt>
<dd><p>If TRUE, the value in a merged cell is given to all cells within the merge.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>data.frame</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Formulae written using writeFormula to a Workbook object will not get picked up by read.xlsx().
This is because only the formula is written and left to be evaluated when the file is opened in Excel.
Opening, saving and closing the file with Excel will resolve this.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="getNamedRegions.html">getNamedRegions()</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Alexander Walker</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xlsxFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"readTest.xlsx"</span>, package <span class="op">=</span> <span class="st">"openxlsx"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span>xlsxFile <span class="op">=</span> <span class="va">xlsxFile</span>, sheet <span class="op">=</span> <span class="fl">1</span>, skipEmptyRows <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">class</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Var1        Var2        Var3        Var4        Var5        Var6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   "logical"   "numeric"   "numeric" "character"   "numeric" "character" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Var7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   "numeric" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span>xlsxFile <span class="op">=</span> <span class="va">xlsxFile</span>, sheet <span class="op">=</span> <span class="fl">3</span>, skipEmptyRows <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df2</span><span class="op">$</span><span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="convertToDate.html">convertToDate</a></span><span class="op">(</span><span class="va">df2</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df2</span>, <span class="va">class</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Date       value        word        bool      wordZ2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      "Date"   "numeric" "character"   "logical" "character" </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Date     value      word  bool  wordZ2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2014-04-28 0.8390764 N-U-B-R-A FALSE FALSE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2014-04-27 0.8863800 N-Z-P-S-Y  TRUE  TRUE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2014-04-26 0.5741314 C-G-D-X-H  TRUE  TRUE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2014-04-25 0.1366065      &lt;NA&gt; FALSE FALSE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2014-04-24 0.3692582 B-K-A-O-W  TRUE  TRUE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2014-04-23        NA H-P-G-O-K  TRUE  TRUE-Z</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span></span></span>
<span class="r-in"><span>  xlsxFile <span class="op">=</span> <span class="va">xlsxFile</span>, sheet <span class="op">=</span> <span class="fl">3</span>, skipEmptyRows <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  detectDates <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">df2</span>, <span class="va">class</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Date       value        word        bool      wordZ2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      "Date"   "numeric" "character"   "logical" "character" </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Date     value      word  bool  wordZ2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2014-04-28 0.8390764 N-U-B-R-A FALSE FALSE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2014-04-27 0.8863800 N-Z-P-S-Y  TRUE  TRUE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2014-04-26 0.5741314 C-G-D-X-H  TRUE  TRUE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2014-04-25 0.1366065      &lt;NA&gt; FALSE FALSE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2014-04-24 0.3692582 B-K-A-O-W  TRUE  TRUE-Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2014-04-23        NA H-P-G-O-K  TRUE  TRUE-Z</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadWorkbook.html">loadWorkbook</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"readTest.xlsx"</span>, package <span class="op">=</span> <span class="st">"openxlsx"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">2</span>, skipEmptyRows <span class="op">=</span> <span class="cn">FALSE</span>, colNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df4</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">xlsxFile</span>, sheet <span class="op">=</span> <span class="fl">2</span>, skipEmptyRows <span class="op">=</span> <span class="cn">FALSE</span>, colNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">df3</span>, <span class="va">df4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="loadWorkbook.html">loadWorkbook</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"readTest.xlsx"</span>, package <span class="op">=</span> <span class="st">"openxlsx"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">wb</span>,</span></span>
<span class="r-in"><span>  sheet <span class="op">=</span> <span class="fl">2</span>, skipEmptyRows <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## URL</span></span></span>
<span class="r-in"><span><span class="co">##</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">xlsxFile</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/awalker89/openxlsx/raw/master/inst/readTest.xlsx"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">read.xlsx</span><span class="op">(</span><span class="va">xlsxFile</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Philipp Schauberger, Alexander Walker, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

